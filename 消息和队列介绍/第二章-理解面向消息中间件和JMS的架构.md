理解面向消息中间件和JMS的架构
===========================
这章节包括:

    * 企业级消息传递和面向消息中间件的架构。
    * 理解JMS（Java Message Service）服务。
    * 使用JMS APIs发送和接收数据。
    * 介绍一个消息驱动的例子。

****

了解通用企业级消息的背景和历史有助于你理解ActiveMQ背后的思想。ActiveMQ不仅仅是JMS broker。ActiveMQ提供了广泛的联通选项。介绍完企业级消息架构后将会有
一些JMS使用的例子。这章节的目的主要是复习一下企业级消息架构和JMS规范。如果你比较熟悉这部分内容，可以直接跳到下一章节阅读。

许多软件开发者需要在应用之间通信传输数据。有各种解决方案，但是依赖各自的约束和需要，决定如何做有很大的困难。商业系统需要考虑许多影响比如:性能，可扩展，可靠性
等等。每天使用的许多应用需要加强上述问题包括：ATMs，航空预定系统，信用卡系统，代销点系统，通信行业等。哪个是能离开我们日常生活的？
他们提供可靠的安全的服务。在这些服务的背后，就是因为他们是许多应用组成的，使用分布式，通过事件或消息通信。甚至许多复杂的金融交易系统集成方式，都是使用消息传递
实现的。许多productors提供消息传递为了各种各样的目的。需求是发明的母亲，消息中间件就是这么产生的。我们非常需要一种更简单的软件，它易于管理，跨平台通信，
不同的数据格式传输数据，不同的传输协议，甚至跨很多语言。提供复杂的消息路由和传输，这个系统就是所说的消息中间件。

ActiveMQ就是消息中间件，对商业系统提供异步的消息传输。通过实现JMS协议的消息中间件，ActiveMQ促进了应用架构可靠性和扩展性。

###2.1 介绍企业级消息传递

直到今天上面提到的大部分系统都在使用大型主机。所以如何保证这些应用的可靠性呢？让我们探索一下企业级消息传递和这些解决方案背后的历史。

从1960年开始，大型机构在关键应用使用了很多大型主机促进数据处理，财务处理，统计分析等等。大型主机提供了没有不间断的服务包括：高可用，冗余，可靠性，扩展性和许多
商业应用需要的其他关键特性。虽然这些系统非常的强大，但是接入这些系统是受限的，只有一小部分接入选项。系统之间的连通还没有被发明，意味着并行处理还是不可能的。

![](https://github.com/zhaoguangnan/activemq-in-action-translate/blob/master/images/terminal-mainframe.png)

终端使用单一协议连接到大型主机(图2.1)

图2.1展示多个终端是如何连接到大型主机的。在1970年，用户开始使用终端访问大型主机，可以有成千上万的人同时使用系统。在这期间计算机网络被发明，连接大型主机变得可能。
到了1980年，不仅图形终端可以使用，而且PCs被发明，终端仿真软件被很快变得常用。互联变得更重要，因为在个人电脑和工作站上开发的应用程序需要访问大型主机。图2.2展示了
各种各样的协议连接到大型主机。注意这样的扩展引入了额外的平台和协议同时也带来的一些问题。

![](https://github.com/zhaoguangnan/activemq-in-action-translate/blob/master/images/many-protocols2mainframe.png)

独立的终端使用许多协议连接到大型主机(图2.2)

连接一个开源系统和目标是系统是不容易的，因为他们有各自的数据格式，硬件兼容性，各自不同的适配协议。随着适配列表的增加不同版本的维护变得非常困难。很快维护适配的成本比系统本身
的比重都大(这是企业级消息进入的场景了)。

企业级消息传递的目的就是在异构的系统之间传输数据。这些年有许多的消息传递方式比如：

    * RPC解决方案比如:COM,CORBA,DCE和EJB。
    * 事件通知解决方案,进程间通信，在进入操作系统消息排队，比如：FIFO buffer,message queues,pipes,signals,sockets等等。
    * 消息中间件解决方案提供异步，可靠消息排队。比如：IBM WebSphere MQ,Sonic MQ,TIBCO Rendezvous,Apache Active MQ。
    一般应用于企业级集成的目的。
    
我们将在这讨论最新的消息中间件产品，什么事正确的面相消息的中间件呢？

###2.2 什么是面向消息的中间件呢？

消息中间件(MOM)是异步通信，松耦合，可靠，可扩展最好的诠释在分布式系统中。MOM是非常重要的概念在分布式计算中。应用之间的通信使用的APIs使用各自厂商提供的，并且在分布式系统领域
处理了很多问题。
整体的概述就是MOM在消息发送者和接受者之间扮演一个媒介。这个媒介提供了一个全新的松耦合形式。在2.3中将介绍MOM是如何使用的，消息传递不仅是应用和大型主机之间，也可以在应用和应用之间
传递。

![](https://github.com/zhaoguangnan/activemq-in-action-translate/blob/master/images/2-F2.3.png)

消息中间件是链接大型主机和保证消息可达的媒介(图2.3)

消息是通过MOM在一个应用到另一个应用之间传递的业务信息单元。应用通过MOM发送消息和接收消息使用约定好的destinations。消息发送和交付到接受者通过连接或者订阅的destinations。
通过这种机制允许发送者和接受者之间松耦合，而且没有要求发送者和消费者同时连接到MOM上。发送者不需要知道接受者的任何事情，接受者也不需要知道发送者的任何事情。这就是所说的异步消息
传递。

MOMs对于企业级消息传递的新特性的是开放的，特性包括：消息持久化，在缓慢或者不可靠的链接中的健壮，复杂的消息路由，消息转发等等。消息持久化有助于减缓因为发送者或者接收者造成的
慢的或者不可靠的链接。当消费者down了不会影响发送者。复杂的消息路由包括的特性：发送一条消息到很多的接收者，消息路由基于属性文件或者消息内容等等。消息转换允许两个应用不处理一样
的消息格式，在自定义消息格式(动态转换)。

另外，当前许多的MOMs提供许多链接协议。一些通用的协议支持包括：HTTP/S，多路广播，SSL，TCP/IP，UDP等等。一些供应商甚至提供多语言，降低使用MOMs的成本在各种环境中。ActiveMQ
正好提供了这些特性甚至更多。

此外，ActiveMQ是典型的MOM，提供提供消息发送和接收的API并且相互影响。很多年，MOM的供应商提供他们特有的APIs还有他们选择的语言直到JMS的出现。

###2.3 什么是JMS？

JMS已中立的方式使用JAVA语言提供了发送和接收消息的标准API。JMS API最小化影响企业消息开发（需要开发复杂消息应用的开发者），同时增加了可移植性。

JMS本身并不是一个MOM。JMS是一个在消息客户端和MOMs相互作用的抽象API，类似于JDBC抽象与关系数据库通信的方式。在2.4小节将展示JMS API如何提供的消息客户端和MOM特性之间
的相互作用的高级功能。JMS为创建企业级消息应用提供了低的门槛，也很容移植到其他的消息提供者。

![](https://github.com/zhaoguangnan/activemq-in-action-translate/blob/master/images/2-F2.4.png)

JMS允许一个客户端很容易链接到许多的JMS提供者(图2.4)

最初JMS是和一些在企业消息产业公司创建的，在1998年第一个版本的JMS规范出现。最新版本的规范在2002年制定出来并且提供了一些必要的改变。JMS 1.1 统一了两种APIs(使用在两个消息域的APIs)。
所以需要使用两个消息域现在仅仅需要一个通用的API就可以了。这是令人激动的APIs改进。向后兼容老的APIs。

在标准化API，JMS正式定义了许多概念和从来没有过的消息：

    * JMS client - 使用JAVA语言编写的发送和接收消息的应用。
    * None-JMS - 使用JMS provider 提供的本地API替代JMS发送和接收的消息。




